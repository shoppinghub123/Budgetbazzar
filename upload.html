<script>
  const form = document.getElementById('uploadForm');

  form.addEventListener('submit', function (e) {
    e.preventDefault();

    const name = document.getElementById('name').value.trim();
    const price = document.getElementById('price').value.trim();
    const stock = document.getElementById('stock').value.trim();
    const category = document.getElementById('category').value;
    const description = document.getElementById('description').value.trim();
    const images = document.getElementById('images').files;

    if (!name || !price || !stock || !category || !description || images.length < 1 || images.length > 3) {
      alert("Fill all fields and upload 1 to 3 images.");
      return;
    }

    const readerPromises = Array.from(images).slice(0, 3).map(file => {
      return new Promise((resolve) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.readAsDataURL(file);
      });
    });

    Promise.all(readerPromises).then(imageURLs => {
      const allProducts = JSON.parse(localStorage.getItem("products")) || [];
      const productID = `product-${Date.now()}`; // Unique ID based on time

      const newProduct = {
        id: productID,
        name,
        price,
        stock,
        category,
        description,
        images: imageURLs
      };

      allProducts.push(newProduct);
      localStorage.setItem("products", JSON.stringify(allProducts));

      alert(`âœ… Product uploaded! Product ID: ${productID}`);
      form.reset();
    });
  });
</script>
